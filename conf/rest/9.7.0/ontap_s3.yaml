name:             OntapS3
query:            api/protocols/s3/buckets
object:           ontaps3

counters:
  - ^^uuid
  - ^encryption.enabled                          => encryption_enabled
  - ^name               => bucket
  - ^svm.name           => svm
  - ^volume.name        => volume
  - logical_used_size
  - size
  - ^policy.statements.0.effect                  => permission_type
  - ^policy.statements.0.actions                 => permissions
  - ^policy.statements.0.principals              => user
  - ^policy.statements.0.resources               => allowed_resources
  - ^protection_status.is_protected              => is_protected
  - ^protection_status.destination.is_ontap      => protected_in_ontap
  - ^protection_status.destination.is_cloud      => protected_in_cloud
  - ^qos_policy.name                             => qos_policy_group

endpoints:
  - query: api/private/cli/vserver/object-store-server/bucket
    counters:
      - ^^uuid
      - object_count

plugins:
  - MetricAgent:
      compute_metric:
        - used_percent PERCENT logical_used_size size
  - OntapS3Service

export_options:
  instance_keys:
    - bucket
    - svm
  instance_labels:
    - volume
    - encryption_enabled
    - permission_type
    - permissions
    - user
    - allowed_resources
    - is_protected
    - protected_in_ontap
    - protected_in_cloud
    - qos_policy_group
    - url
